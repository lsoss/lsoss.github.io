######### 锚点 start #######
# proxy 相关
pr: &pr {type: select, proxies: [Proxy, US, TW, HK, SG, JP, UK, All]}

#这里是订阅更新和延迟测试相关的
p: &p {type: http, interval: 3600, health-check: {enable: true, url: https://google.tw/, interval: 1800}}

use: &use
  type: select
  use:
  - Subscription-A
#- Subscription-B

######### 锚点 end #######


# url 里填写自己的订阅,名称不能重复
proxy-providers:
  Subscription-A:
    <<: *p
    url: "https://m33o212ji.mojieurl.com/api/v1/client/subscribe?token=b6417d2699c959c0ddd25eb148367ca5"

# Subscription-B:
#  path: ./profiles/
#    <<: *p
#    url: "https://nano.nachoneko.cn//api/v1/client/subscribe?token=70bb0280312efce0f2c27fcbd687d9ea"

mode: rule
ipv6: false
log-level: info
allow-lan: true
mixed-port: 7890
unified-delay: false
tcp-concurrent: true
external-controller: 127.0.0.1:9090
keep-alive-interval: 1800
global-client-fingerprint: random  

dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:1053
  nameserver-policy:
   'geosite:geolocation-!cn': [https://1.0.0.1/dns-query, tls://8.8.4.4]
   'GEOSITE:CN': [https://223.5.5.5/dns-query, tls://1.0.0.1]

proxy-groups:

#分隔,下面是地区分组
  - {name: Proxy, type: select, proxies: [US, TW, HK, SG, JP, UK, All]}
  - {name: US, type: url-test, tolerance: 100, lazy: true,  <<: *use, filter: "(?i)美国|us|unitedstates|united states"}
  - {name: TW, type: url-test, tolerance: 100, lazy: true,  <<: *use, filter: "(?i)台湾|tw|taiwan"}
  - {name: HK, type: url-test, tolerance: 100, lazy: true,<<: *use,filter: "(?i)香港|港|hk|hongkong|hong kong"}
  - {name: SG, type: url-test, tolerance: 100, lazy: true,  <<: *use, filter: "(?i)(新加坡|狮城|sg|singapore)"}
  - {name: JP, type: url-test, tolerance: 100, lazy: true,  <<: *use, filter: "(?i)日本|jp|japan"}
  - {name: UK, type: url-test, tolerance: 100, lazy: true,  <<: *use, filter: "(?i)英国|uk|United Kingdom"}
  - {name: All, type: select, tolerance: 100, lazy: true,   <<: *use}




rules:
  - IP-CIDR,194.1.0.0/16,DIRECT
  - GEOSITE,google,Proxy
  - DOMAIN-KEYWORD,bing,DIRECT
  - GEOSITE,geolocation-!cn,Proxy 
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,Proxy

